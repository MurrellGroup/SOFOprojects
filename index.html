<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>KI SOFO - Selected projects</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#ffffff;
      --fg:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --accent:#2563eb;
      --accent-weak:#dbeafe;
      --radius:14px;
      --shadow:0 1px 2px rgba(0,0,0,.05), 0 4px 16px rgba(0,0,0,.06);
      --maxw:1050px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica,Arial,sans-serif;
      color:var(--fg);
      background:var(--bg);
    }
    header.site{
      border-bottom:1px solid var(--line);
      background:#fbfdff;
    }
    .wrap{max-width:var(--maxw); margin:0 auto; padding:24px 18px;}
    h1{font-size:clamp(22px,3vw,32px); margin:0 0 6px 0}
    h2{font-size:clamp(18px,2.2vw,24px); margin:10px 0}
    p.lead{color:var(--muted); margin:6px 0 0 0}
    .controls{display:flex; gap:8px; flex-wrap:wrap; margin-top:14px}
    .btn{
      appearance:none; border:1px solid var(--line); background:#fff; color:var(--fg);
      padding:8px 12px; border-radius:10px; cursor:pointer; box-shadow:var(--shadow);
    }
    .btn:focus{outline:3px solid var(--accent-weak); outline-offset:2px}
    .btn.primary{border-color:var(--accent); color:#0b3aa5}

    /* Directory (auto-built) */
    nav#directory{
      margin:20px 0 6px 0; padding:12px; border:1px solid var(--line); border-radius:var(--radius);
      background:#fcfcff;
    }
    nav#directory h2{margin:0 0 8px 0; font-size:18px}
    #dir-list{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:8px; list-style:none; padding:0; margin:0}
    #dir-list a{
      display:block; padding:8px 10px; border:1px dashed var(--line); border-radius:10px; text-decoration:none; color:inherit;
    }
    #dir-list a:hover{background:#fff; border-color:#c7d2fe}

    /* Project cards (details/summary) */
    section#projects{display:grid; gap:16px; margin-top:14px}
    details.project{
      border:1px solid var(--line); border-radius:var(--radius); background:#fff; box-shadow:var(--shadow);
      overflow:hidden;
    }
    details.project[open]{border-color:#c7d2fe; background:#ffffff}
    summary.project-summary{
      list-style:none; cursor:pointer; display:grid; grid-template-columns:160px 1fr; gap:14px; align-items:center;
      padding:10px; user-select:none;
    }
    summary::-webkit-details-marker{display:none}
    .thumb{
      width:100%; height:100%; border-radius:10px; overflow:hidden; border:1px solid var(--line); background:#f8fafc;
    }
    .thumb svg{display:block; width:100%; height:auto; aspect-ratio:16/9}
    .meta-head{display:flex; flex-direction:column; gap:6px}
    .title{font-size:18px; font-weight:700; margin:0}
    .subtitle{font-size:14px; color:var(--muted); margin:0}
    .badges{display:flex; gap:6px; flex-wrap:wrap; margin-top:4px}
    .badge{font-size:12px; padding:2px 8px; border-radius:999px; border:1px solid var(--line); background:#fff}

    .project-body{padding:12px 14px 18px 14px; border-top:1px solid var(--line); display:grid; gap:16px}
    .section h3{margin:0 0 6px 0; font-size:16px}
    .kv{display:grid; grid-template-columns:1fr 2fr; gap:6px; max-width:780px}
    .kv div{padding:2px 0; border-bottom:1px dotted #eef1f6}
    .media-grid{display:grid; gap:10px; grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
    figure{margin:0}
    figure img, figure video{width:100%; display:block; border-radius:10px; border:1px solid var(--line)}
    figcaption{font-size:12px; color:var(--muted); margin-top:6px}

    footer.site{border-top:1px solid var(--line); margin-top:28px; background:#fafafa; color:#4b5563}
    .small{font-size:13px; color:var(--muted)}

    @media (max-width:640px){
      summary.project-summary{grid-template-columns:1fr}
    }

    /* Print: open everything and simplify */
    @media print{
      .controls, nav#directory{display:none}
      details.project{border:1px solid #ddd; box-shadow:none}
    }
  </style>
</head>
<body>
  <header class="site">
    <div class="wrap">
      <h1>SOFO Comp Bio - Selected projects</h1>
      <p class="lead">A page with student projects from previous summers for Karolinska Institute's "Summer research school in computational biology and bioinformatics" for high school students.</p>
  </header>

  <main class="wrap">
    <section id="projects">
      <!-- ======== PROJECT 1 (placeholder) ======== -->
      <details class="project" id="project-01" data-title="A linear time-complexity Hidden Markov Model for detecting PCR recombination in antibody repertoire sequencing datasets" data-year="2022" open>
        <summary class="project-summary">
          <div class="thumb" aria-hidden="true">
<center>
            <img height="150" src="https://github.com/user-attachments/assets/9283bb9d-56c1-4746-8c6a-c8d79b4f5fcc">
</center>
          </div>
          <div class="meta-head">
            <h2 class="title"><span class="project-title">A linear time-complexity Hidden Markov Model for detecting PCR recombination in antibody repertoire sequencing datasets</span></h2>
            <p class="subtitle">Developing and implementing a novel algorithm to rapidly identify spurious sequences that pollute immunoinformatics datasets.</p>
            <div class="badges" aria-label="tags">
              <span class="badge">next generation sequencing</span>
              <span class="badge">immunoinformatics</span>
              <span class="badge">2022</span>
            </div>
          </div>
        </summary>

        <div class="project-body" id="project-01-content">
          <section class="section">
            <h3>At-a-glance</h3>
            <div class="kv">
              <div><strong>Students</strong></div><div>Aron Stålmarck</div>
              <div><strong>Mentors</strong></div><div>Mark Chernyshev, Ben Murrell</div>
              <div><strong>Cohort</strong></div><div>Summer 2022</div>
              <div><strong>Code</strong></div><div><a href=https://github.com/MurrellGroup/CHMMera.jl>https://github.com/MurrellGroup/CHMMera.jl</a></div>
            </div>
          </section>

          <section class="section">
            <h3>Abstract</h3>
            <p>
              Adaptive Immune Receptor Repertoire sequencing (AIRR-seq) has emerged as a central approach for studying T cell and B cell receptor populations, and is now an important component of studies of autoimmunity, immune responses to pathogens, vaccines, allergens, and cancers, and for antibody discovery. When amplifying the rearranged V(D)J genes encoding antigen receptors, each cycle of the Polymerase Chain Reaction (PCR) can produce spurious “chimeric” hybrids of two or more different template sequences. This project aimed to use a <a href=https://en.wikipedia.org/wiki/Hidden_Markov_model>Hidden Markov Model</a> (HMM) to take a collection of "reference" sequences, and identify query sequences that are spurious chimeras. Initially, the HMM was too slow, scaling with the square of the number of reference sequences (which can be in the hundreds for real-world problems) but we managed to identify some exploitable mathematical structure specific to our problem, and rewrite the HMM maths to be linear in the number of reference sequences, which provided a tractable solution to the problem.
            </p>
<div class="media-grid">
              <figure>
                <img alt="Result figure" src="https://github.com/user-attachments/assets/b5d10c9d-6bd7-4966-bc85-486a45700117">
              </figure>
       		<figure>
                <img alt="Image" src="https://github.com/user-attachments/assets/9eed3e49-b9d2-4904-be03-08eabec72d4a" />
              </figure>
            </div>
          </section>
<p>
This project began in the summer school, where the key algorithmic trick was figured out, but was developed much further, eventually being <a href="https://doi.org/10.1093/bioinformatics/btaf576">published in the journal Bioinformatics.</a>
</p>
        </div>
      </details>






      <details class="project" id="project-02" data-title="Flexible Invariant Point Attention" data-year="2023" open>
        <summary class="project-summary">
          <div class="thumb" aria-hidden="true">
            <img height="150" src="https://github.com/user-attachments/assets/661f6d2a-e9a5-4847-b565-9059bf318941">
          </div>
          <div class="meta-head">
            <h2 class="title"><span class="project-title">Flexible Invariant Point Attention</span></h2>
            <p class="subtitle">Implementing the key SE(3) equivariant layer from AlphaFold2, but with extra flexibility.</p>
            <div class="badges" aria-label="tags">
              <span class="badge">deep learning</span>
              <span class="badge">proteins</span>
              <span class="badge">2023</span>
            </div>
          </div>
        </summary>

        <div class="project-body" id="project-02-content">
          <section class="section">
            <h3>At-a-glance</h3>
            <div class="kv">
              <div><strong>Students</strong></div><div>Lukas Billera</div>
              <div><strong>Mentors</strong></div><div>Ben Murrell</div>
              <div><strong>Cohort</strong></div><div>Summer 2023</div>
              <div><strong>Code</strong></div><div><a href=https://github.com/MurrellGroup/InvariantPointAttention.jl>https://github.com/MurrellGroup/InvariantPointAttention.jl</a></div>
            </div>
          </section>

          <section class="section">
            <h3>Abstract</h3>
            <p>
              Transformer models power most of the recent developments in deep learning and AI. When transformers act on sequences of words, they must know what the word is, and where it is in the sentence so that the relationship to other words can be understood. However, when transformers act on something like the 3-dimensional structure of a protein, these relationships become spatial, with relative 3D position and rotation playing a central role. A large component of the success of AlphaFold 2, which won The 2024 Nobel Prize in Chemistry for protein folding, was the development of a transformer that is invariant to rotation and changes in position, which allows us to build deep learning systems that are <a href="https://en.wikipedia.org/wiki/Equivariant_map">equivariant</a> to rigid-body transformations. The goal of this project was to understand the Invariant Point Attention (IPA) layer from AlphaFold 2, and implement it in the Julia language, allowing for additional customization and flexibility.
            </p>
            <div class="media-grid">
              <figure>
                <img alt="Image" src="https://github.com/user-attachments/assets/073b856b-0cbb-4152-a9e7-9b54cc2c8148" />
              </figure>
            </div>
          </section>
          <p>
            The flexibility afforded by this implementation allowed us to develop an "autoregressive" version of IPA, where each amino acid can be sampled in turn, which was developed into <a href="https://www.biorxiv.org/content/10.1101/2024.05.11.593685v1">a totally new kind of generative model for protein structures.</a>
          </p>
        </div>
      </details>

      <details class="project" id="project-03" data-title="Translationally Equivariant Positional Encodings for Protein Modeling" data-year="2025" open>
        <summary class="project-summary">
          <div class="thumb" aria-hidden="true">
            <img height="150" src="https://github.com/user-attachments/assets/0c0f45bc-1046-4ac6-b811-29bb9a50207f">
          </div>
          <div class="meta-head">
            <h2 class="title"><span class="project-title">Translationally Equivariant Positional Encodings for Protein Modeling</span></h2>
            <p class="subtitle">Implementing learnable, translationally equivariant rotary position embeddings and applying them to side-chain rotamer sampling.</p>
            <div class="badges" aria-label="tags">
              <span class="badge">deep learning</span>
              <span class="badge">proteins</span>
              <span class="badge">2025</span>
            </div>
          </div>
        </summary>

        <div class="project-body" id="project-03-content">
          <section class="section">
            <h3>At-a-glance</h3>
            <div class="kv">
              <div><strong>Students</strong></div><div>[Student Names]</div>
              <div><strong>Mentors</strong></div><div>Ben Murrell</div>
              <div><strong>Cohort</strong></div><div>Summer 2025</div>
              <div><strong>Code</strong></div><div>
                <a href="https://github.com/MurrellGroup/Onion.jl/blob/main/src/positional-encoding/MultidimRoPE.jl">MultidimRoPE.jl</a>, 
                <a href="https://github.com/MurrellGroup/Onion.jl/blob/main/src/positional-encoding/STRING.jl">STRING.jl</a>
              </div>
            </div>
          </section>

          <section class="section">
            <h3>Abstract</h3>
            <p>
              Positional information is crucial for transformers to understand spatial relationships, but for 3D molecular structures, these encodings should ideally respect physical symmetries like translational equivariance. This project explored two different architectural approaches to multidimensional positional encoding. First, we implemented a <b>Multi-dimensional RoPE</b> that generalizes the original rotary position embedding (Su et al., 2021) by applying rotary transforms independently along each coordinate axis. Second, we implemented <b>STRING</b> (Schneck et al., 2025), a learnable rotary embedding designed to ensure true translational equivariance, where the model's internal representation remains invariant even as the molecule shifts in space.
            </p>
            <p>
              We applied these architectures to the problem of protein side-chain rotamer sampling using <b>Flow Matching</b>—a modern generative modeling framework. By training the model to "flow" side-chain atoms from a random initial state toward their correct physical conformations, conditioned on the protein backbone, we developed a method that efficiently captures the complex geometric constraints between neighboring amino acids.
            </p>
            <div class="media-grid">
              <figure>
                <img alt="Protein side-chain sampling animation 1" src="https://github.com/user-attachments/assets/0c0f45bc-1046-4ac6-b811-29bb9a50207f" />
                <figcaption>Generative sampling of protein side-chain rotamers using Flow Matching and translationally equivariant rotary embeddings.</figcaption>
              </figure>
              <figure>
                <img alt="Protein side-chain sampling animation 2" src="https://github.com/user-attachments/assets/a22247d5-98d3-4f6f-bdbf-1ec95161d19c" />
                <figcaption>Repeated independent side chain conformations sampled by the model, from the same backbone.</figcaption>
              </figure>
            </div>
          </section>
        </div>
      </details>











      <!--
        ============================
        TEMPLATE — copy/paste to add a new project
        ============================

        <details class="project" id="project-XX" data-title="Project Title Here" data-year="YYYY">
          <summary class="project-summary">
            <div class="thumb" aria-hidden="true">
              <img src="path/to/your-thumbnail.jpg" alt="Short alt describing the image">
              OR keep the SVG placeholder above
            </div>
            <div class="meta-head">
              <h2 class="title"><span class="project-title">Project Title Here</span></h2>
              <p class="subtitle">One sentence teaser.</p>
              <div class="badges">
                <span class="badge">tag1</span>
                <span class="badge">tag2</span>
                <span class="badge">YYYY</span>
              </div>
            </div>
          </summary>

          <div class="project-body" id="project-XX-content">
            <section class="section">
              <h3>At-a-glance</h3>
              <div class="kv">
                <div><strong>Students</strong></div><div>Names…</div>
                <div><strong>Mentors</strong></div><div>Names…</div>
                <div><strong>School</strong></div><div>Summer YYYY cohort</div>
                <div><strong>Keywords</strong></div><div>list; of; keywords</div>
                <div><strong>Repo / Data</strong></div><div><a href="#">link</a></div>
              </div>
            </section>

            <section class="section">
              <h3>Abstract</h3>
              <p>Short abstract…</p>
            </section>

            <section class="section">
              <h3>Methods</h3>
              <p>Workflow, datasets, tools…</p>
            </section>

            <section class="section">
              <h3>Results</h3>
              <div class="media-grid">
                <figure>
                  <img src="path/to/figure1.png" alt="Describe the figure">
                  <figcaption>Figure caption.</figcaption>
                </figure>
                <figure>
                  <video controls preload="metadata">
                    <source src="path/to/video.mp4" type="video/mp4">
                  </video>
                  <figcaption>Optional video caption.</figcaption>
                </figure>
              </div>
            </section>

            <section class="section">
              <h3>Discussion</h3>
              <p>Interpretation, limitations, future work…</p>
            </section>
          </div>
        </details>
      -->
    </section>
  </main>

  <footer class="site">
    <div class="wrap small">
      <span id="year"></span> Summer Research School in Computational Biology &amp; Bioinformatics.
    </div>
  </footer>

  <script>
    // Build the directory from projects’ data-title (or .project-title text)
    (function buildDirectory(){
      const list = document.getElementById('dir-list');
      const items = Array.from(document.querySelectorAll('details.project'));
      items.forEach(d => {
        const title = d.dataset.title?.trim() || d.querySelector('.project-title')?.textContent?.trim() || d.id;
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = '#' + d.id;
        a.textContent = title;
        li.appendChild(a);
        list.appendChild(li);
      });
    })();

    // Expand / collapse all
    const allDetails = () => Array.from(document.querySelectorAll('details.project'));
    document.getElementById('expandAll').addEventListener('click', () => {
      allDetails().forEach(d => d.open = true);
    });
    document.getElementById('collapseAll').addEventListener('click', () => {
      allDetails().forEach(d => d.open = false);
    });

    // Print helper: open everything before printing
    window.addEventListener('beforeprint', () => { allDetails().forEach(d => d.open = true); });
    document.getElementById('printPage').addEventListener('click', () => { window.print(); });

    // Current year in footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Keyboard: make summaries focusable for accessibility (most browsers already do this)
    document.querySelectorAll('summary').forEach(s => { s.setAttribute('tabindex', '0'); });
  </script>
</body>
</html>
