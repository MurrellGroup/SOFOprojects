<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>KI SOFO - Selected projects</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #ffffff;
      --fg: #09090b;
      --muted: #71717a;
      --line: #e4e4e7;
      --accent: #2563eb;
      --accent-soft: #f1f5f9;
      --radius: 12px;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      --maxw: 94%;
      --header-bg: rgba(255, 255, 255, 0.85);
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #09090b;
        --fg: #fafafa;
        --muted: #a1a1aa;
        --line: #27272a;
        --accent: #60a5fa;
        --accent-soft: #18181b;
        --header-bg: rgba(9, 9, 11, 0.85);
      }
    }

    * { box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      margin: 0;
      font: 16px/1.6 system-ui, -apple-system, sans-serif;
      color: var(--fg);
      background: var(--bg);
      -webkit-font-smoothing: antialiased;
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    header.site {
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      background: var(--header-bg);
      border-bottom: 1px solid var(--line);
    }

    .wrap {
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 24px 3vw;
    }

    .main-layout {
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 60px;
      align-items: start;
    }

    header .wrap {
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 20px;
    }

    .header-content { flex: 1; }

    h1 {
      font-size: clamp(20px, 3vw, 24px);
      font-weight: 700;
      letter-spacing: -0.02em;
      margin: 0;
      background: linear-gradient(to right, var(--fg), var(--accent));
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    h2 { font-size: clamp(18px, 2.2vw, 22px); font-weight: 600; margin: 20px 0 12px; }

    p.lead {
      font-size: 0.95rem;
      color: var(--muted);
      margin: 4px 0 0 0;
    }

    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: nowrap;
      margin-top: 0;
      flex-shrink: 0;
    }

    .btn {
      appearance: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border: 1px solid var(--line);
      background: var(--bg);
      color: var(--fg);
      padding: 6px 14px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: var(--shadow-sm);
    }

    .btn:hover {
      background: var(--accent-soft);
      border-color: var(--accent);
      transform: translateY(-1px);
      box-shadow: var(--shadow);
    }

    .btn.primary {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .btn.primary:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
    }

    /* Directory Sidebar */
    nav#directory {
      position: sticky;
      top: 100px;
      padding: 0;
      border: none;
      background: transparent;
      max-height: calc(100vh - 140px);
      overflow-y: auto;
    }

    nav#directory h2 {
      margin-top: 0;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      border-bottom: 1px solid var(--line);
      padding-bottom: 12px;
      margin-bottom: 16px;
    }

    #dir-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
      list-style: none;
      padding: 0;
    }

    #dir-list a {
      display: block;
      padding: 8px 12px;
      background: transparent;
      border: 1px solid transparent;
      border-radius: 8px;
      text-decoration: none;
      color: var(--muted);
      font-size: 13px;
      font-weight: 500;
      line-height: 1.4;
      transition: all 0.2s;
    }

    #dir-list a:hover {
      background: var(--accent-soft);
      color: var(--accent);
      transform: none;
    }

    /* Project cards */
    section#projects { display: grid; gap: 24px; }

    details.project {
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: var(--bg);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      box-shadow: var(--shadow);
      scroll-margin-top: 100px;
    }

    details.project:hover {
      border-color: var(--accent);
      box-shadow: var(--shadow-lg);
    }

    details.project[open] {
      border-color: var(--accent);
    }

    summary.project-summary {
      list-style: none;
      cursor: pointer;
      display: grid;
      grid-template-columns: 220px 1fr;
      gap: 32px;
      align-items: center;
      padding: 24px;
      user-select: none;
      position: relative;
    }

    summary::-webkit-details-marker { display: none; }

    summary::after {
      content: "↓";
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 18px;
      color: var(--muted);
      transition: transform 0.3s;
    }

    details.project[open] summary::after {
      transform: translateY(-50%) rotate(180deg);
    }

    .thumb {
      width: 100%;
      height: 140px;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid var(--line);
      background: var(--accent-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
    }

    .thumb img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      transition: transform 0.3s;
    }

    .thumb svg {
      width: 100%;
      height: 100%;
      object-fit: contain;
      transition: transform 0.3s;
    }

    details.project:hover .thumb img,
    details.project:hover .thumb svg {
      transform: scale(1.02);
    }

    .meta-head { display: flex; flex-direction: column; gap: 8px; padding-right: 40px; }

    .title { font-size: 20px; font-weight: 700; color: var(--fg); line-height: 1.3; }

    .subtitle { font-size: 15px; color: var(--muted); line-height: 1.5; }

    .badges { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }

    .badge {
      font-size: 12px;
      font-weight: 600;
      padding: 4px 12px;
      border-radius: 999px;
      background: var(--accent-soft);
      color: var(--accent);
      border: 1px solid transparent;
    }

    .project-body {
      padding: 24px;
      border-top: 1px solid var(--line);
      background: var(--bg);
      display: grid;
      gap: 32px;
    }

    .section h3 {
      margin: 0 0 12px 0;
      font-size: 18px;
      font-weight: 700;
      color: var(--fg);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .kv {
      display: grid;
      grid-template-columns: 100px 1fr;
      gap: 12px;
      max-width: 1000px;
    }

    .kv strong { color: var(--muted); font-size: 14px; text-transform: uppercase; letter-spacing: 0.05em; }

    .kv div { padding: 4px 0; }

    .media-grid {
      display: grid;
      gap: 24px;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }

    figure { margin: 0; }

    figure img, figure video {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 12px;
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
    }

    figcaption {
      font-size: 14px;
      color: var(--muted);
      margin-top: 12px;
      text-align: center;
      font-style: italic;
    }

    footer.site {
      border-top: 1px solid var(--line);
      margin-top: 64px;
      background: var(--accent-soft);
      padding: 48px 0;
    }

    .small { font-size: 14px; color: var(--muted); text-align: center; }

    @media (max-width: 900px) {
      .main-layout { grid-template-columns: 1fr; gap: 24px; }
      nav#directory { position: static; max-height: none; margin-bottom: 24px; border-bottom: 1px solid var(--line); padding-bottom: 24px; }
      #dir-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); }
    }

    @media (max-width: 768px) {
      header .wrap { flex-direction: column; gap: 12px; }
      .controls { width: 100%; justify-content: flex-start; }
      summary.project-summary { grid-template-columns: 1fr; }
      .meta-head { padding-right: 0; }
      .kv { grid-template-columns: 1fr; gap: 4px; }
      .kv strong { display: block; margin-top: 8px; }
    }

    @media print {
      .controls, nav#directory, header.site, summary::after { display: none; }
      details.project { border: 1px solid #ccc; box-shadow: none; margin-bottom: 20px; }
      .project-body { background: white; }
    }
  </style>
</head>
<body>
  <header class="site">
    <div class="wrap">
      <div class="header-content">
        <h1>SOFO Comp Bio</h1>
        <p class="lead">Selected student projects from the Karolinska Institute summer research school in computational biology and bioinformatics.</p>
      </div>
      <div class="controls">
        <button class="btn primary" id="expandAll">Expand All</button>
        <button class="btn" id="collapseAll">Collapse All</button>
      </div>
    </div>
  </header>

  <main class="wrap main-layout">
    <nav id="directory" aria-label="Project directory">
      <h2>Project Directory</h2>
      <ul id="dir-list"></ul>
    </nav>

    <section id="projects">
      <!-- ======== PROJECT 1 (placeholder) ======== -->
      <details class="project" id="project-01" data-title="A linear time-complexity Hidden Markov Model for detecting PCR recombination in antibody repertoire sequencing datasets" data-year="2022">
        <summary class="project-summary">
          <div class="thumb" aria-hidden="true">
            <img src="https://github.com/user-attachments/assets/9283bb9d-56c1-4746-8c6a-c8d79b4f5fcc" alt="">
          </div>
          <div class="meta-head">
            <h2 class="title"><span class="project-title">A linear time-complexity Hidden Markov Model for detecting PCR recombination in antibody repertoire sequencing datasets</span></h2>
            <p class="subtitle">Developing and implementing a novel algorithm to rapidly identify spurious sequences that pollute immunoinformatics datasets.</p>
            <div class="badges" aria-label="tags">
              <span class="badge">next generation sequencing</span>
              <span class="badge">immunoinformatics</span>
              <span class="badge">2022</span>
            </div>
          </div>
        </summary>

        <div class="project-body" id="project-01-content">
          <section class="section">
            <h3>At-a-glance</h3>
            <div class="kv">
              <div><strong>Students</strong></div><div>Aron Stålmarck</div>
              <div><strong>Mentors</strong></div><div>Mark Chernyshev, Ben Murrell</div>
              <div><strong>Cohort</strong></div><div>Summer 2022</div>
              <div><strong>Code</strong></div><div><a href=https://github.com/MurrellGroup/CHMMera.jl>https://github.com/MurrellGroup/CHMMera.jl</a></div>
            </div>
          </section>

          <section class="section">
            <h3>Abstract</h3>
            <p>
              Adaptive Immune Receptor Repertoire sequencing (AIRR-seq) has emerged as a central approach for studying T cell and B cell receptor populations, and is now an important component of studies of autoimmunity, immune responses to pathogens, vaccines, allergens, and cancers, and for antibody discovery. When amplifying the rearranged V(D)J genes encoding antigen receptors, each cycle of the Polymerase Chain Reaction (PCR) can produce spurious “chimeric” hybrids of two or more different template sequences. This project aimed to use a <a href=https://en.wikipedia.org/wiki/Hidden_Markov_model>Hidden Markov Model</a> (HMM) to take a collection of "reference" sequences, and identify query sequences that are spurious chimeras. Initially, the HMM was too slow, scaling with the square of the number of reference sequences (which can be in the hundreds for real-world problems) but we managed to identify some exploitable mathematical structure specific to our problem, and rewrite the HMM maths to be linear in the number of reference sequences, which provided a tractable solution to the problem.
            </p>
<div class="media-grid">
              <figure>
                <img alt="Result figure" src="https://github.com/user-attachments/assets/b5d10c9d-6bd7-4966-bc85-486a45700117">
              </figure>
       		<figure>
                <img alt="Image" src="https://github.com/user-attachments/assets/9eed3e49-b9d2-4904-be03-08eabec72d4a" />
              </figure>
            </div>
          </section>
<p>
This project began in the summer school, where the key algorithmic trick was figured out, but was developed much further, eventually being <a href="https://doi.org/10.1093/bioinformatics/btaf576">published in the journal Bioinformatics.</a>
</p>
        </div>
      </details>






      <details class="project" id="project-02" data-title="Flexible Invariant Point Attention" data-year="2023">
        <summary class="project-summary">
          <div class="thumb" aria-hidden="true">
            <img src="https://github.com/user-attachments/assets/661f6d2a-e9a5-4847-b565-9059bf318941" alt="">
          </div>
          <div class="meta-head">
            <h2 class="title"><span class="project-title">Flexible Invariant Point Attention</span></h2>
            <p class="subtitle">Implementing the key SE(3) equivariant layer from AlphaFold2, but with extra flexibility.</p>
            <div class="badges" aria-label="tags">
              <span class="badge">deep learning</span>
              <span class="badge">proteins</span>
              <span class="badge">2023</span>
            </div>
          </div>
        </summary>

        <div class="project-body" id="project-02-content">
          <section class="section">
            <h3>At-a-glance</h3>
            <div class="kv">
              <div><strong>Students</strong></div><div>Lukas Billera</div>
              <div><strong>Mentors</strong></div><div>Ben Murrell</div>
              <div><strong>Cohort</strong></div><div>Summer 2023</div>
              <div><strong>Code</strong></div><div><a href=https://github.com/MurrellGroup/InvariantPointAttention.jl>https://github.com/MurrellGroup/InvariantPointAttention.jl</a></div>
            </div>
          </section>

          <section class="section">
            <h3>Abstract</h3>
            <p>
              Transformer models power most of the recent developments in deep learning and AI. When transformers act on sequences of words, they must know what the word is, and where it is in the sentence so that the relationship to other words can be understood. However, when transformers act on something like the 3-dimensional structure of a protein, these relationships become spatial, with relative 3D position and rotation playing a central role. A large component of the success of AlphaFold 2, which won The 2024 Nobel Prize in Chemistry for protein folding, was the development of a transformer that is invariant to rotation and changes in position, which allows us to build deep learning systems that are <a href="https://en.wikipedia.org/wiki/Equivariant_map">equivariant</a> to rigid-body transformations. The goal of this project was to understand the Invariant Point Attention (IPA) layer from AlphaFold 2, and implement it in the Julia language, allowing for additional customization and flexibility.
            </p>
            <div class="media-grid">
              <figure>
                <img alt="Image" src="https://github.com/user-attachments/assets/073b856b-0cbb-4152-a9e7-9b54cc2c8148" />
              </figure>
            </div>
          </section>
          <p>
            The flexibility afforded by this implementation allowed us to develop an "autoregressive" version of IPA, where each amino acid can be sampled in turn, which was developed into <a href="https://www.biorxiv.org/content/10.1101/2024.05.11.593685v1">a totally new kind of generative model for protein structures.</a>
          </p>
        </div>
      </details>

      <details class="project" id="project-02b" data-title="Smoothing the Selection: Bayesian Inference of dN/dS with Random Fourier Features" data-year="2024">
        <summary class="project-summary">
          <div class="thumb" aria-hidden="true">
            <svg viewBox="0 0 100 100">
              <rect x="10" y="10" width="80" height="80" fill="none" stroke="#cbd5e1" stroke-width="0.5"/>
              <path d="M10 80 Q 30 20, 50 50 T 90 40" fill="none" stroke="#2563eb" stroke-width="2"/>
              <circle cx="30" cy="38" r="2" fill="#ef4444"/>
              <circle cx="50" cy="50" r="2" fill="#ef4444"/>
              <circle cx="70" cy="45" r="2" fill="#ef4444"/>
              <line x1="10" y1="10" x2="10" y2="90" stroke="#94a3b8" stroke-width="1"/>
              <line x1="10" y1="90" x2="90" y2="90" stroke="#94a3b8" stroke-width="1"/>
            </svg>
          </div>
          <div class="meta-head">
            <h2 class="title"><span class="project-title">Smoothing the Selection: Bayesian Inference of dN/dS with Random Fourier Features</span></h2>
            <p class="subtitle">Extending the FUBAR method by using Random Fourier Features and MCMC to impose a smooth prior over the dN/dS grid.</p>
            <div class="badges" aria-label="tags">
              <span class="badge">evolutionary biology</span>
              <span class="badge">bayesian statistics</span>
              <span class="badge">2024</span>
            </div>
          </div>
        </summary>

        <div class="project-body" id="project-02b-content">
          <section class="section">
            <h3>At-a-glance</h3>
            <div class="kv">
              <div><strong>Students</strong></div><div>Hedwig Nora Nordlinder and L.G.</div>
              <div><strong>Mentors</strong></div><div>Ben Murrell</div>
              <div><strong>Cohort</strong></div><div>Summer 2024</div>
              <div><strong>Code</strong></div><div><a href=https://github.com/MurrellGroup/CodonMolecularEvolution.jl>https://github.com/MurrellGroup/CodonMolecularEvolution.jl</a></div>
            </div>
          </section>

          <section class="section">
            <h3>Abstract</h3>
            <p>
              Quantifying natural selection at the molecular level often involves estimating the ratio of nonsynonymous to synonymous substitution rates (dN/dS). The <b>FUBAR</b> (Fast Unconstrained Bayesian AppRoximation) method approximates the posterior distribution of selection across a gene using a pre-computed grid of rates and a Dirichlet prior. However, the original FUBAR assumes that the prior probability of each grid cell is independent. This project aimed to extend FUBAR by imposing a <b>smooth prior</b> over the discretized dN/dS distribution surface. Instead of a standard Dirichlet distribution, we used <b>Random Fourier Features</b> (RFF) to parameterize a continuous surface over the grid. By using <b>Markov Chain Monte Carlo</b> (MCMC) to sample from the weights of these features, we can more robustly estimate the landscape of selection, effectively sharing information between neighboring rate categories while maintaining computational tractability.
            </p>
            <div class="media-grid">
              <figure>
                <video controls autoplay loop muted playsinline>
                  <source src="https://github.com/user-attachments/assets/5d9da706-1ed5-4690-aa82-62dd4ad065f2" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
                <figcaption>Animation of the smooth prior distribution over the dN/dS grid surface.</figcaption>
              </figure>
              <figure>
                <video controls autoplay loop muted playsinline>
                  <source src="https://github.com/user-attachments/assets/b228fce9-a25b-4397-be6d-6f64ad644e55" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
                <figcaption>Animation of the resulting posterior distribution, capturing the landscape of selection.</figcaption>
              </figure>
            </div>
          </section>
        </div>
      </details>

      <details class="project" id="project-03" data-title="Translationally Equivariant Positional Encodings for Protein Modeling" data-year="2025">
        <summary class="project-summary">
          <div class="thumb" aria-hidden="true">
            <img src="https://github.com/user-attachments/assets/0c0f45bc-1046-4ac6-b811-29bb9a50207f" alt="">
          </div>
          <div class="meta-head">
            <h2 class="title"><span class="project-title">Translationally Equivariant Positional Encodings for Protein Modeling</span></h2>
            <p class="subtitle">Implementing learnable, translationally equivariant rotary position embeddings and applying them to side-chain rotamer sampling.</p>
            <div class="badges" aria-label="tags">
              <span class="badge">deep learning</span>
              <span class="badge">proteins</span>
              <span class="badge">2025</span>
            </div>
          </div>
        </summary>

        <div class="project-body" id="project-03-content">
          <section class="section">
            <h3>At-a-glance</h3>
            <div class="kv">
              <div><strong>Students</strong></div><div>B.H. and A.K.</div>  
              <div><strong>Mentors</strong></div><div>Aron Stålmarck and Ben Murrell</div>
              <div><strong>Cohort</strong></div><div>Summer 2025</div>
              <div><strong>Code</strong></div><div>
                <a href="https://github.com/MurrellGroup/Onion.jl/blob/main/src/positional-encoding/MultidimRoPE.jl">MultidimRoPE.jl</a>, 
                <a href="https://github.com/MurrellGroup/Onion.jl/blob/main/src/positional-encoding/STRING.jl">STRING.jl</a>
              </div>
            </div>
          </section>

          <section class="section">
            <h3>Abstract</h3>
            <p>
              Positional information is crucial for transformers to understand spatial relationships, but for 3D molecular structures, these encodings should ideally respect physical symmetries like translational equivariance. This project explored two different architectural approaches to multidimensional positional encoding. First, we implemented a <b>Multi-dimensional RoPE</b> that generalizes the original rotary position embedding (Su et al., 2021) by applying rotary transforms independently along each coordinate axis. Second, we implemented <b>STRING</b> (Schneck et al., 2025), a learnable rotary embedding designed to ensure true translational equivariance, where the model's internal representation remains invariant even as the molecule shifts in space.
            </p>
            <p>
              We applied these architectures to the problem of protein side-chain rotamer sampling using <b>Flow Matching</b>—a modern generative modeling framework. By training the model to "flow" side-chain atoms from a random initial state toward their correct physical conformations, conditioned on the protein backbone, we developed a method that efficiently captures the complex geometric constraints between neighboring amino acids.
            </p>
            <div class="media-grid">
              <figure>
                <img alt="Protein side-chain sampling animation 1" src="https://github.com/user-attachments/assets/0c0f45bc-1046-4ac6-b811-29bb9a50207f" />
                <figcaption>Generative sampling of protein side-chain rotamers using Flow Matching and translationally equivariant rotary embeddings.</figcaption>
              </figure>
              <figure>
                <img alt="Protein side-chain sampling animation 2" src="https://github.com/user-attachments/assets/a22247d5-98d3-4f6f-bdbf-1ec95161d19c" />
                <figcaption>Repeated independent side chain conformations sampled by the model, from the same backbone.</figcaption>
              </figure>
            </div>
          </section>
        </div>
      </details>

      <details class="project" id="project-04" data-title="Autoregressive 3D Molecular Generation" data-year="2025">
        <summary class="project-summary">
          <div class="thumb" aria-hidden="true">
            <svg viewBox="0 0 100 100">
              <circle cx="30" cy="40" r="8" fill="#64748b"/>
              <circle cx="70" cy="30" r="6" fill="#94a3b8"/>
              <circle cx="50" cy="70" r="10" fill="#475569"/>
              <line x1="30" y1="40" x2="50" y2="70" stroke="#cbd5e1" stroke-width="3"/>
              <line x1="70" y1="30" x2="50" y2="70" stroke="#cbd5e1" stroke-width="3"/>
            </svg>
          </div>
          <div class="meta-head">
            <h2 class="title"><span class="project-title">Autoregressive 3D Molecular Generation</span></h2>
            <p class="subtitle">Building a transformer that grows molecules one atom at a time, predicting both chemical identity and 3D geometry.</p>
            <div class="badges" aria-label="tags">
              <span class="badge">generative AI</span>
              <span class="badge">chemistry</span>
              <span class="badge">2025</span>
            </div>
          </div>
        </summary>

        <div class="project-body" id="project-04-content">
          <section class="section">
            <h3>At-a-glance</h3>
            <div class="kv">
              <div><strong>Students</strong></div><div>Adam Mehranrad and Alice Stenbeck</div>
              <div><strong>Mentors</strong></div><div>Anton Oresten and Ben Murrell</div>
              <div><strong>Cohort</strong></div><div>Summer 2025</div>
            </div>
          </section>

          <section class="section">
            <h3>Abstract</h3>
            <p>
              Generative models for 3D molecules have immense potential in drug discovery and materials science. This project developed an autoregressive transformer-based architecture in the Julia language that constructs molecules atom-by-atom. Unlike models that generate entire molecular graphs simultaneously, this approach treats molecule building as a sequential growth process. For each step, the model predicts the next atom's chemical identity, its 3D displacement relative to a selected "anchor" atom, and a "climb" variable that selects the next anchor point for subsequent growth steps, effectively navigating the branching structure derived from SMILES strings.
            </p>
          
            <p>
              The <b>MOGMOG</b> architecture combines a multi-channel token encoder with a deep transformer trunk. The encoder integrates chemical identity, 3D coordinates, and sequence indices into a rich representation. A unique <b>Mixture of Gaussians (MoG)</b> decoder is used to model the continuous 3D displacement vectors, allowing the model to capture the multimodal spatial distributions of atom placements. The transformer's attention mechanism is further augmented by a learned <b>pairwise attention bias</b>, which incorporates relative 3D distances and structural relations between atoms at multiple length scales.
            </p>
            <div class="media-grid">
              <figure>
                <img alt="Training loss curve" src="https://github.com/user-attachments/assets/7236ad19-9386-4545-8e46-324871260dcf" />
                <figcaption>Training loss.</figcaption>
              </figure>
              <figure>
                <img alt="Generated molecule sample 1" src="https://github.com/user-attachments/assets/4f4b514f-f6b1-4a94-a619-477e64c5b4d6" />
                <figcaption>A 3D molecular structure generated by the model.</figcaption>
              </figure>
              <figure>
                <img alt="Generated molecule sample 2" src="https://github.com/user-attachments/assets/fe7f8acc-0ee2-4842-a58f-c3abb7d22542" />
                <figcaption>Additional generated sample showing structural diversity.</figcaption>
              </figure>
            </div>
          </section>
        </div>
      </details>











      <!--
        ============================
        TEMPLATE — copy/paste to add a new project
        ============================

        <details class="project" id="project-XX" data-title="Project Title Here" data-year="YYYY">
          <summary class="project-summary">
            <div class="thumb" aria-hidden="true">
              <img src="path/to/your-thumbnail.jpg" alt="Short alt describing the image">
              OR keep the SVG placeholder above
            </div>
            <div class="meta-head">
              <h2 class="title"><span class="project-title">Project Title Here</span></h2>
              <p class="subtitle">One sentence teaser.</p>
              <div class="badges">
                <span class="badge">tag1</span>
                <span class="badge">tag2</span>
                <span class="badge">YYYY</span>
              </div>
            </div>
          </summary>

          <div class="project-body" id="project-XX-content">
            <section class="section">
              <h3>At-a-glance</h3>
              <div class="kv">
                <div><strong>Students</strong></div><div>Names…</div>
                <div><strong>Mentors</strong></div><div>Names…</div>
                <div><strong>School</strong></div><div>Summer YYYY cohort</div>
                <div><strong>Keywords</strong></div><div>list; of; keywords</div>
                <div><strong>Repo / Data</strong></div><div><a href="#">link</a></div>
              </div>
            </section>

            <section class="section">
              <h3>Abstract</h3>
              <p>Short abstract…</p>
            </section>

            <section class="section">
              <h3>Methods</h3>
              <p>Workflow, datasets, tools…</p>
            </section>

            <section class="section">
              <h3>Results</h3>
              <div class="media-grid">
                <figure>
                  <img src="path/to/figure1.png" alt="Describe the figure">
                  <figcaption>Figure caption.</figcaption>
                </figure>
                <figure>
                  <video controls preload="metadata">
                    <source src="path/to/video.mp4" type="video/mp4">
                  </video>
                  <figcaption>Optional video caption.</figcaption>
                </figure>
              </div>
            </section>

            <section class="section">
              <h3>Discussion</h3>
              <p>Interpretation, limitations, future work…</p>
            </section>
          </div>
        </details>
      -->
    </section>
  </main>

  <footer class="site">
    <div class="wrap small">
      <span id="year"></span> Summer Research School in Computational Biology &amp; Bioinformatics.
    </div>
  </footer>

  <script>
    // Build the directory from projects’ data-title (or .project-title text)
    (function buildDirectory(){
      const list = document.getElementById('dir-list');
      const items = Array.from(document.querySelectorAll('details.project'));
      items.forEach(d => {
        const title = d.dataset.title?.trim() || d.querySelector('.project-title')?.textContent?.trim() || d.id;
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = '#' + d.id;
        a.textContent = title;
        li.appendChild(a);
        list.appendChild(li);
      });
    })();

    // Expand / collapse all
    const allDetails = () => Array.from(document.querySelectorAll('details.project'));
    document.getElementById('expandAll').addEventListener('click', () => {
      allDetails().forEach(d => d.open = true);
    });
    document.getElementById('collapseAll').addEventListener('click', () => {
      allDetails().forEach(d => d.open = false);
    });

    // Print helper: open everything before printing
    window.addEventListener('beforeprint', () => { allDetails().forEach(d => d.open = true); });

    // Current year in footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Keyboard: make summaries focusable for accessibility (most browsers already do this)
    document.querySelectorAll('summary').forEach(s => { s.setAttribute('tabindex', '0'); });
  </script>
</body>
</html>
